---
title: Set-CsImFilterConfiguration
TOCTitle: Set-CsImFilterConfiguration
ms:assetid: c2b08cc0-8261-4b8b-b2e9-5efa902ceb40
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg412960(v=OCS.15)
ms:contentKeyID: 49311075
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Set-CsImFilterConfiguration

 

_**Дата изменения раздела:** 2015-03-09_

Изменяет существующую конфигурацию фильтра мгновенных сообщений. Параметры фильтра мгновенных сообщений служат для предотвращения отправки пользователями мгновенных сообщений, содержащих активные гиперссылки. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Set-CsImFilterConfiguration [-Identity <XdsIdentity>] <COMMON PARAMETERS>

    Set-CsImFilterConfiguration [-Instance <PSObject>] <COMMON PARAMETERS>

    COMMON PARAMETERS: [-Action <Allow | Block | Warn>] [-AllowMessage <String>] [-BlockFileExtension <$true | $false>] [-Confirm [<SwitchParameter>]] [-Enabled <$true | $false>] [-Force <SwitchParameter>] [-IgnoreLocal <$true | $false>] [-Prefixes <PSListModifier>] [-WarnMessage <String>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

Команда, показанная в этом примере, отключает фильтрацию универсальных кодов ресурсов (URI) для конфигурации фильтра мгновенных сообщений с идентификатором site:Redmond. Для этого вызывается командлет **Set-CsImFilterConfiguration** с параметром Enabled, для которого указано значение $False.

    Set-CsImFilterConfiguration -Identity site:Redmond -Enabled $False

## ПРИМЕР 2

В примере 2 в список запрещенных префиксов для конфигурации фильтра мгновенных сообщений с идентификатором site:Redmond добавляется новый префикс универсального кода ресурса (urn:). Для добавления этого префикса вызывается командлет **Get-CsImFilterConfiguration**, который извлекает конфигурацию с идентификатором site:Redmond. Полученный объект, представляющий эту конфигурацию, сохраняется в переменной с именем $x. После извлечения параметров в строке 2 вызывается метод Add() для добавления префикса urn: в набор префиксов, хранящихся в свойстве Prefixes. При этом изменяется значение ссылки на объект $x. Для изменения самой конфигурации в строке 3 вызывается командлет **Set-CsImFilterConfiguration**, которому передается единственное значение параметра $x.

    $x = Get-CsImFilterConfiguration -Identity site:Redmond
    $x.Prefixes.Add("urn:")
    Set-CsImFilterConfiguration -Instance $x

## ПРИМЕР 3

В примере 3 выполняются те же действия, что и в примере 2, но в одной строке. В этой команде для добавления префикса urn: в список префиксов используется параметр Prefixes командлета **Set-CsImFilterConfiguration**. Модификатор списка add служит для добавления этого значения в список Prefixes.

    Set-CsImFilterConfiguration -Identity site:Redmond -Prefixes @{add="urn:"}

## ПРИМЕР 4

В этом примере префикс urn: удаляется из списка префиксов, которые блокируются конфигурацией фильтра мгновенных сообщений для сайта site:Redmond. Этот пример идентичен примеру 3 за тем исключением, что вместо использования модификатора списка add, который добавляет префикс в список, используется модификатор remove, который удаляет префикс.

    Set-CsImFilterConfiguration -Identity site:Redmond -Prefixes @{remove="urn:"}

## Подробное описание

При отправке мгновенных сообщений пользователи могут включать в текст универсальные коды ресурсов (URI), щелкнув которые другие участники беседы могут перейти на определенный веб-сайт или к определенному общему ресурсу. Lync Server можно настроить так, что гиперссылки с определенными префиксами будут блокироваться или будут неактивны. (Иными словами, участники не смогут перейти на сайт, на который указывает код URI, просто щелкнув ссылку. Они должны скопировать ссылку и вставить ее в адресную строку браузера вручную.)

Командлет **Set-CsImFilterConfiguration** позволяет изменить список префиксов URI, которые должны отфильтровываться, а также включить или отключить фильтрацию на глобальном уровне или для определенного сайта. С помощью этого командлета можно также изменить различные сообщения с предупреждениями, которые получают пользователи.

По умолчанию право на локальный запуск командлета **Set-CsImFilterConfiguration** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Set-CsImFilterConfiguration"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Action</em></p></td>
<td><p>Необязательный</p></td>
<td><p>UrlFilterAction</p></td>
<td><p>Значение этого параметра определяет действие, которое будет выполняться в случае, если в мгновенном сообщении имеется гиперссылка.</p>
<p>Allow — перед гиперссылкой добавляется символ подчеркивания, что делает ее неактивной. Кроме того, если для свойства AllowMessage задано значение, в начало каждого мгновенного сообщения, содержащего гиперссылки, будет добавляться уведомление.</p>
<p>Block — доставка сообщений, содержащих активные гиперссылки, блокируется, и сервер Lync Server посылает отправителю сообщение об ошибке.</p>
<p>Warn — сообщения, содержащие активные гиперссылки, доставляются получателям, но в начало каждого такого сообщения добавляется предупреждение. Текст предупреждения можно задать с помощью свойства WarnMessage. Если выбрано значение Warn, но свойство WarnMessage не задано, фильтрация мгновенных сообщений отключается, но значение параметра BlockFileExtension по-прежнему учитывается.</p>
<p></p></td>
</tr>
<tr class="even">
<td><p><em>AllowMessage</em></p></td>
<td><p>Необязательный</p></td>
<td><p>String</p></td>
<td><p>Если для этого параметра задано значение, соответствующая строка добавляется в начало каждого сообщения, содержащего гиперссылки, при условии что свойство Action имеет значение Allow. С помощью этой строки можно уведомить пользователей, например, о возможной опасности, связанной с переходом по неизвестным ссылкам, или о соответствующих политиках и требованиях, действующих в организации.</p></td>
</tr>
<tr class="odd">
<td><p><em>BlockFileExtension</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Boolean</p></td>
<td><p>Если для этого параметра задано значение True, гиперссылка, которая содержит путь к файлу с расширением, указанным в свойстве Extensions класса Microsoft.Rtc.Management.WritableConfig.Settings.ImFilter.FileTransferFilterConfiguration (извлекается путем вызова командлета <strong>Get-CsFileTransferFilterConfiguration</strong>), блокируется, а отправитель получает сообщение об ошибке. Если задано значение False, никакой особой проверки путей к файлам и расширений не производится.</p>
<p>Значение по умолчанию — True</p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>Enabled</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Boolean</p></td>
<td><p>Включает или отключает данную возможность. Если для этого параметра задано значение True, мгновенные сообщения будут проверяться на наличие гиперссылок и в случае их наличия будут применяться настроенные правила. Если задано значение False, сообщения не будут проверяться на наличие гиперссылок.</p>
<p>Значение по умолчанию — True</p></td>
</tr>
<tr class="even">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Подавляет все запросы на подтверждение, которые в противном случае будут отображаться перед применением изменений.</p></td>
</tr>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Необязательный</p></td>
<td><p>XdsIdentity</p></td>
<td><p>Уникальный идентификатор конфигурации фильтра мгновенных сообщений, которую необходимо изменить. Допустимые значения: global или site:&lt;имя_сайта&gt;, где &lt;имя_сайта&gt; — это сайт, к которому применяется конфигурация, например site:Redmond.</p>
<p></p></td>
</tr>
<tr class="even">
<td><p><em>IgnoreLocal</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Boolean</p></td>
<td><p>Значение этого параметра определяет, должна ли выполняться фильтрация универсальных кодов ресурсов (URI) в местной интрасети, передаваемых в мгновенных сообщениях. Если для этого параметра задано значение True, коды URI, определенные в зоне интрасети локального компьютера, игнорируются. (Локальный компьютер — это сервер переднего плана, на котором выполняется приложение фильтрации мгновенных сообщений.) Если задано значение False, фильтрация применяется ко всем гиперссылкам.</p>
<p>Значение по умолчанию — True</p></td>
</tr>
<tr class="odd">
<td><p><em>Instance</em></p></td>
<td><p>Необязательный</p></td>
<td><p>ImFilterConfiguration</p></td>
<td><p>Позволяет передавать ссылку на объект в командлет вместо установки значений для отдельных параметров. Данный командлет принимает объект типа Microsoft.Rtc.Management.WritableConfig.Settings.ImFilter.ImFilterConfiguration, который можно получить с помощью командлета <strong>Get-CsImFilterConfiguration</strong>.</p></td>
</tr>
<tr class="even">
<td><p><em>Prefixes</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PSListModifier</p></td>
<td><p>Список префиксов URI, которые будут отфильтровываться. Если в мгновенном сообщении имеется гиперссылка с одним из префиксов из списка, она будет фильтроваться в соответствии с указанными параметрами.</p>
<p>Список по умолчанию: callto:, file:, ftp., ftp:, gopher:, href, http:, https:, ldap:, mailto:, news:, nntp:, sip:, sips:, tel:, telnet:, www*.</p></td>
</tr>
<tr class="odd">
<td><p><em>WarnMessage</em></p></td>
<td><p>Необязательный</p></td>
<td><p>String</p></td>
<td><p>Этот параметр содержит текст предупреждения, который добавляется в начало каждого мгновенного сообщения, содержащего гиперссылки, если свойство Action имеет значение Warn. Как правило, это предупреждение используется для информирования о возможной опасности, связанной с переходом по неизвестным ссылкам, или о соответствующих политиках и требованиях, действующих в организации.</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Объект Microsoft.Rtc.Management.WritableConfig.Settings.ImFilter.ImFilterConfiguration. Принимает входные данные из конвейера в виде объекта конфигурации фильтра мгновенных сообщений.

## Типы возвращаемых данных

Командлет **Set-CsImFilterConfiguration** не возвращает значений или объектов. Вместо этого он настраивает экземпляры объекта Microsoft.Rtc.Management.WritableConfig.Settings.ImFilter.ImFilterConfiguration.

## См. также

#### Другие ресурсы

[New-CsImFilterConfiguration](new-csimfilterconfiguration.md)  
[Remove-CsImFilterConfiguration](remove-csimfilterconfiguration.md)  
[Get-CsImFilterConfiguration](get-csimfilterconfiguration.md)

