---
title: New-CsCdrConfiguration
TOCTitle: New-CsCdrConfiguration
ms:assetid: e5890ac3-7a6c-4609-a866-84c39b76d3a9
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg399018(v=OCS.15)
ms:contentKeyID: 49311481
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# New-CsCdrConfiguration

 

_**Дата изменения раздела:** 2015-03-09_

Создает новый набор параметров регистрации вызовов (CDR). Регистрация вызовов позволяет отслеживать использование одноранговых сеансов обмена мгновенными сообщениями, телефонных звонков по протоколу VoIP, конференц-связи и т. д. Данные об использовании включают информацию о вызывающей и вызываемой сторонах, времени звонка и продолжительности разговора. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    New-CsCdrConfiguration -Identity <XdsIdentity> [-Confirm [<SwitchParameter>]] [-EnableCDR <$true | $false>] [-EnablePurging <$true | $false>] [-Force <SwitchParameter>] [-InMemory <SwitchParameter>] [-KeepCallDetailForDays <UInt32>] [-KeepErrorReportForDays <UInt32>] [-PurgeHourOfDay <UInt32>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

Команда в примере 1 использует командлет **New-CsCdrConfiguration** для создания нового набора параметров CDR с удостоверением site:Redmond. Кроме удостоверения site:Redmond новые параметры также имеют свойство EnableCDR, установленное в значение False. Поскольку параметры узла имеют преимущество перед глобальными параметрами, это означает, что регистрация вызовов не будет использоваться на узле Redmond, независимо от того, включена ли она на глобальном уровне.

    New-CsCdrConfiguration -Identity site:Redmond -EnableCDR $False

## ПРИМЕР 2

В примере 2 параметр InMemory используется для демонстрации создания новой коллекции параметров конфигурации регистрации вызовов, которая первоначально существует только в памяти. Для этого сначала с помощью командлета **New-CsCdrConfiguration** и параметра InMemory создается виртуальная коллекция параметров с удостоверением site:Redmond. Эта виртуальная коллекция сохраняется в переменной $x; если этого не сделать, то коллекция будет создана, а затем сразу же исчезнет.

После создания виртуальной коллекции команда, показанная в строке 2, устанавливает свойство EnableCDR в значение ($False). Затем в строке 3 с помощью командлета **Set-CsCdrConfiguration** виртуальная коллекция $x преобразуется в фактическую коллекцию параметров конфигурации CDR, которая применяется к узлу Redmond. Если не вызвать командлет **Set-CsCdrConfiguration**, то виртуальная коллекция исчезнет сразу же после окончания сеанса Windows PowerShell или удаления переменной $x.

    $x = New-CsCdrConfiguration -Identity site:Redmond -InMemory
    $x.EnableCDR = $False
    Set-CsCdrConfiguration -Instance $x

## Подробное описание

Регистрация вызовов (CDR) предоставляет способ отслеживания использования возможностей Lync Server, таких как телефонные звонки по протоколу VoIP, обмен мгновенными сообщениями, передачи файлов, аудио- и видеоконференции, сеансы общего доступа к приложениям. Регистрация вызовов (доступная только после развертывания службы мониторинга) отслеживает сведения об использовании: регистрирует в журнале такие сведения, как участников разговора, длительность разговора, факты передачи каких-либо файлов. (Однако CDR не записывает сам разговор.)

CDR также отслеживает сведения об ошибках вызовов: подробные диагностические данные для одноранговых сеансов и для конференц-вызовов.

Как администратор, можно определить, используется ли в вашей организации регистрация вызовов; если служба мониторинга развернута, то можно легко включить или отключить CDR. Кроме того, это решение можно принять на глобальном уровне (в этом случае CDR будет включаться или отключаться во всей организации) или на уровне узла; например, можно использовать CDR на узле Redmond, но не на узле Paris.

Командлет **New-CsCdrConfiguration** позволяет создавать новые коллекции параметров CDR на уровне узла. (Новые параметры нельзя создавать на глобальном уровне.) Обратите внимание, что узел может размещать только одну коллекцию параметров CDR. Это означает, что что если узел Redmond уже имеет набор параметров конфигурации CDR, то нельзя создать новую коллекцию для этого узла. При попытке сделать это команда завершится неудачно.

По умолчанию право на локальный запуск командлета **New-CsCdrConfiguration** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "New-CsCdrConfiguration"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Обязательный</p></td>
<td><p>Microsoft.Rtc.Management.Xds.XdsIdentity</p></td>
<td><p>Представляет уникальный идентификатор, который должен быть назначен новой коллекции параметров конфигурации CDR. Поскольку новые коллекции можно создавать только на уровне узла, удостоверение всегда будет иметь префикс &quot;site:&quot;, за которым будет следовать имя узла, например &quot;site:Redmond&quot;.</p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableCDR</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Указывает, включен ли CDR. По умолчанию установлено значение True.</p></td>
</tr>
<tr class="even">
<td><p><em>EnablePurging</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Указывает, будут ли записи CDR периодически удаляться из базы данных CDR. Если этот параметр имеет значение True (значение по умолчанию), то записи будут удаляться после истечения периода времени, заданного свойствами KeepCallDetailForDays (для записей CDR) и KeepErrorReportForDays (для ошибок CDR). Если параметр имеет значение False, то записи CDR будут поддерживаться неопределенное время.</p></td>
</tr>
<tr class="odd">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Подавляет отображение любых сообщений о некритических ошибках, которые могут возникать при выполнении этой команды.</p></td>
</tr>
<tr class="even">
<td><p><em>InMemory</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Создает ссылку на объект без фиксации объекта в качестве постоянного изменения. Если выходные данные этого командлета, вызванного с помощью указанного параметра, назначаются переменной, можно внести изменения в свойства ссылки на объект и затем зафиксировать эти изменения, вызвав соответствующий командлет Set-.</p></td>
</tr>
<tr class="odd">
<td><p><em>KeepCallDetailForDays</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает количество дней, которое записи CDR будут сохраняться в базе данных CDR; все записи старше указанного количества дней будут автоматически удаляться. (Обратите внимание, что очистка будет выполняться только в том случае, если свойство EnablePurging имеет значение True.)</p>
<p>В качестве значения параметра KeepCallDetailForDays может быть установлено любое целое число от 1 до 2562 дней (приблизительно 7 лет). Значение по умолчанию — 60 дней.</p></td>
</tr>
<tr class="even">
<td><p><em>KeepErrorReportForDays</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает число дней, в течение которого сохраняются отчеты об ошибках CDR; все отчеты старше указанного числа дней будут автоматически удаляться. Отчеты об ошибках CDR представляют собой диагностические отчеты, которые отправляют клиентские приложения, такие как Lync 2013.</p>
<p>В качестве значения этого свойства можно задать любое целое значение от 1 до 2562 дней (приблизительно 7 лет). По умолчанию установлено 60 дней.</p></td>
</tr>
<tr class="odd">
<td><p><em>PurgeHourOfDay</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает местное время суток для удаления записей с истекшим сроком действия из базы данных CDR. Время суток задается в 24-часовом формате (0 соответствует полуночи (00:00), а 23 — 23:00 часам вечера). Обратите внимание, что можно указать только час, т. е. удаление можно запланировать на 4:00 утра, но не на 4:30 или 4:15. Значение по умолчанию — 2 часа утра (02:00). Рекомендуется выполнять удаление в нерабочее время.</p>
<p>Очистка базы данных выполняется только в том случае, если свойство EnablePurging установлено в значение True.</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Нет. Командлет **New-CsCdrConfiguration** не принимает входные данные из конвейера.

## Типы возвращаемых данных

Создает экземпляры объекта Microsoft.Rtc.Management.WritableConfig.Settings.CallDetailRecording.CdrSettings.

## См. также

#### Другие ресурсы

[Get-CsCdrConfiguration](get-cscdrconfiguration.md)  
[Remove-CsCdrConfiguration](remove-cscdrconfiguration.md)  
[Set-CsCdrConfiguration](set-cscdrconfiguration.md)

