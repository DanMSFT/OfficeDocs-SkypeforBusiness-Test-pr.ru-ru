---
title: Get-CsOnlineUser
TOCTitle: Get-CsOnlineUser
ms:assetid: 2bfafd70-a7d9-4308-a353-5ecf44249b53
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ994026(v=OCS.15)
ms:contentKeyID: 52058181
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Get-CsOnlineUser

 

_**Дата изменения раздела:** 2015-03-09_

Возвращает сведения о пользователях с учетными записями, размещенными в клиенте Microsoft Lync Online. Этот командлет можно использовать только с Skype для бизнеса Online.

## Синтаксис

    Get-CsOnlineUser [[-Identity] <UserIdParameter>] [-Filter <String>] [-LdapFilter <String>] [-OnOfficeCommunicationServer] [-OnLyncServer] [-UnAssignedUser] [-OU <OUIdParameter>] [-DomainController <Fqdn>] [-Credential <PSCredential>] [-ResultSize <Unlimited`1>] [-Verbose]

## Примеры

## Пример 1

Команда, показанная в примере 1, возвращает сведения обо всех пользователях, настроенных как интернет-пользователи.

    Get-CsOnlineUser

## Пример 2

В примере 2 возвращаются сведения для одного интернет-пользователя — пользователя с SIP-адресом "sip:kenmyer@litwareinc.com".

    Get-CsOnlineUser -Identity "sip:kenmyer@litwareinc.com"

## Пример 3

Команда, показанная в примере 3, возвращает сведения для всех интернет пользователей Lync Online, которым не назначен пул Registrar.

    Get-CsOnlineUser -UnassignedUser

## Пример 4

В примере 4 используется параметр Filter, чтобы ограничить возвращаемые данные интернет-пользователями, которые были назначены политике архивирования уровня пользователей RedmondArchiving. Для этого используется значение фильтра {ArchivingPolicy -eq "RedmondArchiving"}, которое ограничивает возвращаемые данные пользователями, у которых свойство ArchivingPolicy имеет значение (-eq) "RedmondArchiving".

    Get-CsOnlineUser -Filter {ArchivingPolicy -eq "RedmondArchiving"}

## Пример 5

В примере 5 возвращается информация только для пользовательских учетных записей, которые настроены так, чтобы они не отображаются в списке адресов Microsoft Exchange. (Т. е. атрибут Active Directory msExchHideFromAddressLists имеет значение True.) Для выполнения этой задачи используется параметр Filter со значением {HideFromAddressLists -eq $True}.

    Get-CsOnlineUser -Filter {HideFromAddressLists -eq $True}

## Пример 6

Команда, показанная в примере 6, возвращает сведения для всех интернет-пользователей, назначенных клиенту с идентификатором "bf19b7db-6960-41e5-a139-2aa373474354". Для выполнения этой задачи команда включает параметр Filter вместе со значением фильтра {TenantId –eq "bf19b7db-6960-41e5-a139-2aa373474354"}. Этот фильтр ограничивает возвращаемые данные интернет-пользователями, назначенными клиенту "bf19b7db-6960-41e5-a139-2aa373474354".

    Get-CsOnlineUser -Filter {TenantId -eq "bf19b7db-6960-41e5-a139-2aa373474354"}

## Подробное описание

Командлет **Get-CsOnlineUser** возвращает сведения о пользователях с учетными записями, размещенными в Microsoft Lync Online. Возвращаемые сведения содержат стандартную информацию об учетных записях Active Directory (например, отдел, в котором работают пользователи, их адреса и номера телефонов и т. д.), а также характерную для Lync Server информацию: командлет **Get-CsOnlineUser** возвращает информацию, которая указывает, разрешено ли пользователю использовать корпоративную голосовую связь и какие политики уровня пользователей (если есть) назначены данному пользователю.

Обратите внимание, что у командлета **Get-CsOnlineUser** нет параметра TenantId. Это означает, что подобную команду возможно использовать, чтобы ограничить возвращаемые данные пользователями, у которых есть учетные записи с конкретным клиентом Lync Online:

    Get-CsOnlineUser -TenantId "bf19b7db-6960-41e5-a139-2aa373474354"

Однако, если есть несколько клиентов Lync Online, сведения о пользователях указанного клиента можно получить с помощью параметра Filter и команды, подобной следующей:

    Get-CsOnlineUser -Filter {TenantId -eq "bf19b7db-6960-41e5-a139-2aa373474354"}

Эта команда ограничивает возвращаемые данные пользовательскими учетными записями, принадлежащими к клиенту с идентификатором "bf19b7db-6960-41e5-a139-2aa373474354". Если идентификаторы клиентов неизвестны, такие сведения можно получить с помощью следующей команды:

    Get-CsTenant

В случае гибридного развертывания или развертывания "разделенного домена" (т. е., развертывания, в котором у одних пользователей учетные записи размещены в Lync Online, а у других — в локальной версии Lync Server) следует помнить о том, что командлет **Get-CsOnlineUser** возвращает только сведения для пользователей Lync Online. Однако командлет [Get-CsUser](get-csuser.md) возвращает сведения как для пользователей Lync Online, так и для пользователей локальной версии Lync Server. Если требуется исключить пользователей Lync Online из в данных, возвращаемых комнадлетом **Get-CsUser**, используется следующая команда:

    Get-CsUser -Filter {TenantId -eq "00000000-0000-0000-0000-000000000000"}

По определению у пользователей локальной версии Lync Server свойство TenantId всегда равно 00000000-0000-0000-0000-000000000000. У пользователей, размещенных в Lync Online, значение свойства TenantId всегда отлично от 00000000-0000-0000-0000-000000000000.

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный?</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Credential</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.PSCredential</p></td>
<td><p>Позволяет выполнить командлет <strong>Get-CsOnlineUser</strong> с использованием альтернативных учетных данных. Это может потребоваться в случае, если учетная запись, используемая для входа в Windows, не обладает необходимыми привилегиями для работы с объектами пользователей.</p>
<p>Чтобы использовать параметр Credential, необходимо сначала создать объект PSCredential с помощью командлета <strong>Get-Credential</strong>. Дополнительные сведения см. в разделе справки, посвященном командлету <strong>Get-Credential</strong>.</p></td>
</tr>
<tr class="even">
<td><p><em>DomainController</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.Deploy.Fqdn</p></td>
<td><p>Позволяет подключиться к определенному контроллеру домена для получения пользовательской информации. Чтобы подключиться к определенному контроллеру домена, следует добавить параметр DomainController, за которым следует полное доменное имя (FQDN) (например, atl-cs-001.litwareinc.com).</p></td>
</tr>
<tr class="odd">
<td><p><em>Filter</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Позволяет ограничить возвращаемые данные путем фильтрации по специфическим атрибутам Lync Server. Например, можно включить в возвращаемые данные только пользователей, которым была назначена конкретная политика голосовой связи, или пользователей, которым эта политика не была назначена.</p>
<p>Для параметра Filter используется тот же синтаксис фильтрации Windows PowerShell, что и для командлета Where-Object. Например, фильтр, возвращающий только пользователей, которым был разрешен доступ к корпоративной голосовой связи, выглядел бы следующим образом, где EnterpriseVoiceEnabled обозначает атрибут Active Directory, -eq обозначает оператор сравнения (равно), а $True (встроенная переменная Windows PowerShell) обозначает фильтруемое значение:</p>
<p>{EnterpriseVoiceEnabled -eq $True}</p></td>
</tr>
<tr class="even">
<td><p><em>Identity</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.AD.UserIdParameter</p></td>
<td><p>Указывает идентификатор возвращаемой учетной записи пользователя. Идентификатор могут указываться в одном из четырех форматов: 1) SIP-адрес пользователя; 2) имя участника-пользователя (UPN); 3) доменное имя пользователя и имя для входа в виде домен\имя_входа (например, litwareinc\kenmyer); 4) отображаемое имя пользователя Active Directory (например, Ken Myer). Для указания учетной записи пользователя можно также использовать его различающееся имя в Active Directory.</p>
<p>При использовании отображаемого имени в качестве идентификатора пользователя можно применять подстановочный символ звездочки (*). Например, идентификация по имени &quot;* Smith&quot; вернет всех пользователей, у которых отображаемое имя завершается в строке значением &quot; Smith&quot;.</p></td>
</tr>
<tr class="odd">
<td><p><em>LdapFilter</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Позволяет ограничить возвращаемые данные путем фильтрации по общим атрибутам Active Directory (то есть атрибутам, которые не являются специфическими для Lync Server). Например, можно включить в возвращаемые данные только пользователей, работающих в конкретном отделе, или пользователей с указанным менеджером или должностью.</p>
<p>В параметре LdapFilter для создания фильтров используется язык запросов LDAP. Например, фильтр, возвращающий пользователей, работающих только в городе Редмонд, выглядит так: &quot;l=Redmond&quot;, где &quot;l&quot; (строчная буква L) обозначает атрибут Active Directory (locality, местоположение); &quot;=&quot; обозначает оператор сравнения (равняется); а &quot;Redmond&quot; обозначает фильтруемое значение.</p></td>
</tr>
<tr class="even">
<td><p><em>OnLyncServer</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Возвращает коллекцию пользователей Lync Server. Пользователи с учетными записями из предыдущих версий программного обеспечения не возвращаются при использовании этого параметра.</p></td>
</tr>
<tr class="odd">
<td><p><em>OnOfficeCommunicationServer</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Возвращает коллекцию пользователей предыдущей версии Lync Server (например, Microsoft Office Communications Server 2007 R2). Пользователи с учетными записями из текущей версии программного обеспечения не возвращаются при использовании этого параметра.</p></td>
</tr>
<tr class="even">
<td><p><em>OU</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.AD.OUIdParameter</p></td>
<td><p>Позволяет возвращать информацию об учетных записях пользователей в конкретном подразделении (OU) или контейнере. Параметр OU возвращает данные из указанного подразделения и всех его дочерних подразделений. Например, если финансовое подразделение имеет два дочерних подразделения AccountsPayable и AccountsReceivable, возвращаются пользователи из всех трех подразделений.</p>
<p>При указании полразделения используйте различающееся имя (DN) этого контейнера, например: -OU &quot;OU=Finance,dc=litwareinc,dc=com&quot;. Чтобы вернуть учетные записи пользователей из контейнера &quot;Пользователи&quot;, используйте следующий синтаксис:</p>
<p>-OU &quot;cn=Users,dc=litwareinc,dc=com&quot;</p></td>
</tr>
<tr class="odd">
<td><p><em>ResultSize</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.ADConnect.Core.Unlimited</p></td>
<td><p>Позволяет ограничить количество записей, возвращаемых командлетом. Например, чтобы в результатах были данные о 7 пользователях (независимо от количества пользователей в лесу), добавьте параметр ResultSize со значением 7. Следует отметить, что будут возвращены данные о случайных семи пользователях.</p>
<p>В качестве размера результата можно задать любое целое число от 0 до 2147483647 включительно. Если задано значение 0, команда выполняется, но данные не возвращаются. Если в лес входят только 3 пользователя, а параметру ResultSize задано значение 7, то команда вернет этих трех пользователей, а затем завершится без ошибки.</p></td>
</tr>
<tr class="even">
<td><p><em>UnassignedUser</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Позволяет вернуть коллекцию пользователей, которым был разрешен доступ к Lync Online, но которые в настоящее время не назначены пулу Registrar. Пользователи не могут входить в систему, если они не назначены пулу Registrar.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Командлет **Get-CsOnlineUser** принимает по конвейеру экземпляры объекта Microsoft.Rtc.Management.ADConnect.Schema.OCSADUser, а также строковые значения, представляющие допустимое удостоверение учетной записи пользователя (например, "sip:kenmyer@litwareinc.com").

## Типы возвращаемых данных

Командлет **Get-CsOnlineUser** возвращает экземпляры объекта Microsoft.Rtc.Management.ADConnect.Schema.ADOCOnlineUser.

## См. также

#### Другие ресурсы

[Get-CsUser](get-csuser.md)

