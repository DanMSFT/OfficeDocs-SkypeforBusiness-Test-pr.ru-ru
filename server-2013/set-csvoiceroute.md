---
title: Set-CsVoiceRoute
TOCTitle: Set-CsVoiceRoute
ms:assetid: b786aec0-946e-4ce5-812e-25e5d8cfa4d5
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg412893(v=OCS.15)
ms:contentKeyID: 49310947
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Set-CsVoiceRoute

 

_**Дата изменения раздела:** 2015-03-09_

Изменяет маршрут голосовых вызовов. Маршруты голосовых вызовов содержат инструкции, которые сообщают Lync Server, как нужно маршрутизировать вызовы от пользователей корпоративной голосовой связи на телефонные номера в телефонной сети общего пользования (PSTN) или PBX. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Set-CsVoiceRoute [-Identity <XdsGlobalRelativeIdentity>] <COMMON PARAMETERS>

    Set-CsVoiceRoute [-Instance <PSObject>] <COMMON PARAMETERS>

    COMMON PARAMETERS: [-AlternateCallerId <String>] [-Confirm [<SwitchParameter>]] [-Description <String>] [-Force <SwitchParameter>] [-NumberPattern <String>] [-Priority <Int32>] [-PstnGatewayList <PSListModifier>] [-PstnUsages <PSListModifier>] [-SuppressCallerId <$true | $false>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

Эта команда задает описание маршрута голосовых вызовов Route1 ("Test Route").

    Set-CsVoiceRoute -Identity Route1 -Description "Test Route"

## ПРИМЕР 2

Команда в этом примере изменяет маршрут голосовых вызовов с удостоверением Route1, чтобы добавить междугороднюю связь ТСОП в список методов использования этого маршрута голосовых вызовов. Междугородняя связь должна быть указана в списке глобальных режимов работы с ТСОП (который можно получить, вызвав командлет **Get-CsPstnUsage**).

    Set-CsVoiceRoute -Identity Route1 -PstnUsages @{add="Long Distance"}

## ПРИМЕР 3

Этот пример изменяет маршрут голосовых вызовов Route1 для заполнения списка режимов работы с ТСОП маршрута всеми существующими в организации способами использования. Первая команда в примере получает список глобальных режимов работы с ТСОП. Учтите, что вызов командлета **Get-CsPstnUsage** заключен в скобки. Это означает, что сначала извлекается объект с информацией о режимах работы с ТСОП. (Так как существует только один режим работы с ТСОП, глобальный, будет извлечен только один объект.) Команда затем получает свойство Usage этого объекта. Данное свойство, которое содержит список режимов работы с ТСОП, назначается переменной $x. Во второй строке примера вызывается командлет **Set-CsVoiceRoute** для изменения маршрута голосовых вызовов с удостоверением Route1. Обратите внимание на значения, переданные в параметре PstnUsages: @{replace=$x}. Это значение обозначает необходимости заменить все в списке PstnUsages этого маршрута на переменную $x, которая содержит список режимов работы с ТСОП, полученный в строке 1.

    $x = (Get-CsPstnUsage).Usage
    Set-CsVoiceRoute -Identity Route1 -PstnUsages @{replace=$x}

## ПРИМЕР 4

Этот набор команд меняет свойство Name маршрута голосовых вызовов с удостоверением Route1 на RouteA. Изменение свойства Name автоматически меняет свойство Identity, в этом случае оно меняется на RouteA.

В первой строке вызывается командлет **Get-CsVoiceRoute** для получения маршрута голосовых вызовов с удостоверением Route1. Возвращенный объект сохраняется в переменной $x. Затем свойству Name этого объекта назначается строковое значение "RouteA". И, наконец, объект (в переменной $x) передается в параметре Instance командлета **Set-CsVoiceRoute** для внесения изменения.

    $x = Get-CsVoiceRoute -Identity Route1
    $x.Name = "RouteA"
    Set-CsVoiceRoute -Instance $x

## ПРИМЕР 5

Этот пример изменяет маршрут голосовых вызовов с именем Route1 и заполняет список шлюзов ТСОП этого маршрута (PstnGatewayList) серверной ролью шлюза с удостоверением PstnGateway:192.168.0.100. В первой строке примера вызывается командлет **Get-CsVoiceRoute** для получения маршрута голосовых вызовов, который нужно изменить, в данном случае это Route1. Затем вызывается метод Add свойства PstnGatewayList маршрута Route1. Методу Add передается удостоверение службы, которую требуется добавить. Наконец, вызывается командлет **Set-CsVoiceRoute**, при этом в параметре Instance передается переменная $y. Это обновит Route1 (в переменной $y) на добавленный шлюз ТСОП.

    $y = Get-CsVoiceRoute -Identity Route1
    $y.PstnGatewayList.Add("PstnGateway:192.168.0.100")
    Set-CsVoiceRoute -Instance $y

## Подробное описание

Используйте этот командлет для изменения существующего маршрута голосовых вызовов. Маршруты голосовых вызовов сопоставлены с политиками голосовой связи с помощью режимов работы с PSTN. Маршрут голосовых вызовов содержит регулярное выражение, определяющее, какие телефонные номера будут направляться по указанному маршруту голосовых вызовов: телефонные номера, соответствующие регулярному выражению, будут направлены по этому маршруту.

По умолчанию право на локальный запуск командлета **Set-CsVoiceRoute** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Set-CsVoiceRoute"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>AlternateCallerId</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Если для параметра SuppressCallerId задано значение True, принимающие стороны увидят значение параметра AlternateCallerId, а не фактический номер вызывающего. Этот номер должен быть допустимым номером и может использоваться для представления подразделения организации, например службы поддержки или отдела кадров.</p>
<p>Если для параметра SuppressCallerId задано значение False, параметр AlternateCallerId игнорируется.</p>
<p>Это значение должно соответствовать регулярному выражению (\+)?[1-9]\d*(;ext=[1-9]\d*)?. Другими словами, значение может начинаться со знака плюс (+), но это необязательно. Оно должно состоять из любого числа цифр и после него может идти расширение, начинающееся с &quot;;ext=&quot;, за которым следует любое число цифр. (Учтите, что если включить расширение, строку необходимо заключить в двойные кавычки.)</p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>Description</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Описание назначения этого телефонного маршрута.</p></td>
</tr>
<tr class="even">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Подавляет все запросы на подтверждение, которые в противном случае будут отображаться перед применением изменений.</p></td>
</tr>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.Xds.XdsGlobalRelativeIdentity</p></td>
<td><p>Уникальное удостоверение маршрута голосовых вызовов. (Если имя маршрута голосовых вызовов содержит пробел, например &quot;Test Route&quot;, необходимо заключить всю строку в круглые скобки.)</p>
<p></p></td>
</tr>
<tr class="even">
<td><p><em>Instance</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Route</p></td>
<td><p>Позволяет передать в командлет ссылку на объект вместо задания значений отдельных параметров. Это должен быть объект типа Microsoft.Rtc.Management.WritableConfig.Policy.Voice.Route. Его можно получить, вызвав командлет <strong>Get-CsVoiceRoute</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><em>NumberPattern</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Регулярное выражение, определяющее телефонные номера, к которым применяется этот маршрут. Номера, соответствующие этому шаблону, будут направляться в соответствии с остальными параметрами маршрутизации. Например, шаблон номеров по умолчанию, [0-9]{10}, определяет 10-разрядный номер с любыми цифрами от 0 до 9.</p></td>
</tr>
<tr class="even">
<td><p><em>Priority</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Int32</p></td>
<td><p>Номер может разрешаться в несколько маршрутов голосовых вызовов. Приоритет определяет порядок применения маршрутов, если доступно несколько из них.</p></td>
</tr>
<tr class="odd">
<td><p><em>PstnGatewayList</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.PSListModifier</p></td>
<td><p>Сервер-посредник можно сопоставить с несколькими шлюзами. Этот параметр содержит список шлюзов, связанных с этим маршрутом голосовых вызовов. Каждый участник этого списка должен быть удостоверением шлюза PSTN или сервера-посредника. Значение может относиться к cерверу-посреднику, только если сервер-посредник настроен для Microsoft Office Communications Server 2007 или Microsoft Office Communications Server 2007 R2. Для применения Lync Server необходимо использовать шлюз PSTN. Удостоверение службы — это строка в формате роль_службы:FQDN, где роль_службы — это имя роли службы (PSTNGateway), а FQDN — полное доменное имя пула или IP-адрес сервера, например, PSTNGateway:redmondpool.litwareinc.com. Удостоверения службы можно получить с помощью команды Get-CsService | Select-Object Identity.</p>
<p>Если вы вносите изменения в маршрут голосовых вызовов и оставляете список PstnGatewayList пустым или применяемое изменение удаляет все элементы из списка, отображается предупреждение о том, что пользователи не смогут выполнять вызовы PSTN.</p></td>
</tr>
<tr class="even">
<td><p><em>PstnUsages</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.PSListModifier</p></td>
<td><p>Список режимов работы с PSTN (например, Local (локальные) или Long Distance (междугородняя связь)), которые можно применить к этому маршруту голосовых вызовов. Режим работы с PSTN должен существовать. (Режимы работы с PSTN можно получить с помощью командлета <strong>Get-CsPstnUsage</strong>.)</p>
<p>Если вы вносите изменения в маршрут голосовых вызовов и оставляете список PstnUsages пустым или применяемое изменение удаляет все режимы работы с PSTN из списка, отображается предупреждение о том, что пользователи не смогут выполнять вызовы PSTN.</p></td>
</tr>
<tr class="odd">
<td><p><em>SuppressCallerId</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Определяет, будет ли разглашаться идентификатор звонящего при исходящих вызовах. Если для этого параметра задано значение True, идентификатор звонящего подавляется. Вместо фактического идентификатора отображается значение AlternateCallerId. Если для параметра SuppressCallerId задано значение True, необходимо указать значение AlternateCallerId.</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Объект Microsoft.Rtc.Management.WritableConfig.Policy.Voice.Route. Командлет **Set-CsVoiceRoute** принимает входные данные объектов маршрутов голосовых вызовов из конвейера.

## Типы возвращаемых данных

Командлет **Set-CsVoiceRoute** не возвращает значение или объект. Вместо этого командлет настраивает экземпляры объекта Microsoft.Rtc.Management.WritableConfig.Policy.Voice.Route.

## См. также

#### Другие ресурсы

[New-CsVoiceRoute](new-csvoiceroute.md)  
[Remove-CsVoiceRoute](remove-csvoiceroute.md)  
[Get-CsVoiceRoute](get-csvoiceroute.md)  
[Test-CsVoiceRoute](test-csvoiceroute.md)  
[Get-CsPstnUsage](get-cspstnusage.md)  
[Get-CsService](get-csservice.md)

