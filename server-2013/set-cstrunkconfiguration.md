---
title: Set-CsTrunkConfiguration
TOCTitle: Set-CsTrunkConfiguration
ms:assetid: 18152388-68de-4a6b-b5a1-248534ecde72
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg398238(v=OCS.15)
ms:contentKeyID: 49309075
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Set-CsTrunkConfiguration

 

_**Дата изменения раздела:** 2015-02-27_

Изменяет существующую магистральную конфигурацию, которая описывает настройки для магистрального объекта, такого как шлюз телефонной сети общего пользования (PSTN), PBX с поддержкой IP или пограничный контроллер сеансов (SBC) у поставщика услуг. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Set-CsTrunkConfiguration [-Identity <XdsIdentity>] <COMMON PARAMETERS>

    Set-CsTrunkConfiguration [-Instance <PSObject>] <COMMON PARAMETERS>

    COMMON PARAMETERS: [-ConcentratedTopology <$true | $false>] [-Confirm [<SwitchParameter>]] [-Description <String>] [-Enable3pccRefer <$true | $false>] [-EnableBypass <$true | $false>] [-EnableFastFailoverTimer <$true | $false>] [-EnableLocationRestriction <$true | $false>] [-EnableMobileTrunkSupport <$true | $false>] [-EnableOnlineVoice <$true | $false>] [-EnablePIDFLOSupport <$true | $false>] [-EnableReferSupport <$true | $false>] [-EnableRTPLatching <$true | $false>] [-EnableSessionTimer <$true | $false>] [-EnableSignalBoost <$true | $false>] [-Force <SwitchParameter>] [-ForwardCallHistory <$true | $false>] [-ForwardPAI <$true | $false>] [-MaxEarlyDialogs <UInt32>] [-NetworkSiteID <String>] [-OutboundCallingNumberTranslationRulesList <PSListModifier>] [-OutboundTranslationRulesList <PSListModifier>] [-PstnUsages <PSListModifier>] [-RemovePlusFromUri <$true | $false>] [-RTCPActiveCalls <$true | $false>] [-RTCPCallsOnHold <$true | $false>] [-SipResponseCodeTranslationRulesList <PSListModifier>] [-SRTPMode <Required | Optional | NotSupported>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

В этом примере магистральная конфигурация с удостоверением site:Redmond меняется для включения обхода мультимедиа. Это достигается за счет присвоения значения $True параметру EnableBypass. Оставшиеся свойства этой конфигурации сохраняют имеющиеся значения.

    Set-CsTrunkConfiguration -Identity site:Redmond -EnableBypass $True

## ПРИМЕР 2

В этом примере изменяется правило исходящего преобразования, заданное для магистральной конфигурации с удостоверением site:Redmond. Обратите внимание, что для применения этого изменения командлет **Set-CsTrunkConfiguration** фактически не вызывается. Изменения в **Set-CsOutboundTranslationRule** автоматически отражаются в магистральной конфигурации с удостоверением, соответствующим части с областью действия удостоверения правила исходящего преобразования.

    Set-CsOutboundTranslationRule -Identity site:Redmond/OTR1 -Translation '$1'

## ПРИМЕР 3

В примере 3 для свойства SRTPMode для всех магистральных конфигураций, определенных в области действия сайта, задается значение "Optional". Первая часть команды — это вызов командлета **Get-CsTrunkConfiguration**, который использует параметр Filter для получения всех магистральных конфигураций с удостоверением, которое начинается с "site:", т. е. всех конфигураций, заданных на уровне сайта. Эта коллекция конфигураций затем передается в командлет **Set-CsTrunkConfiguration**, который задает для свойства SRTPMode каждой конфигурации значение "Optional".

    Get-CsTrunkConfiguration -Filter site:* | Set-CsTrunkConfiguration -SRTPMode "Optional"

## ПРИМЕР 4

В примере 4 магистральная конфигурация с удостоверением site:Redmond меняется для включения поддержки PIDF-LO. По умолчанию параметр EnablePIDFLOSupport имеет значение False. В этом примере мы установили значение True, чтобы включить поддержку расположения для экстренных вызовов. Необходимо установить для EnablePIDFLOSupport значение True, чтобы сведения о расположении отправлялись в магистраль приложением исходящей маршрутизации.

    Set-CsTrunkConfiguration -Identity site:Redmond -EnablePIDFLOSupport $True

## Подробное описание

Используйте этот командлет для изменения магистральной конфигурации, применяемой к объектам шлюза PSTN. Каждая конфигурация содержит определенные параметры для магистрального объекта, такого как шлюз PSTN, IP-PBX или SBC у поставщика услуг. Эти параметры управляют, например, тем, включен ли обход мультимедиа в этой магистрали, отправляются пакеты RTCP в определенных условиях и следует ли использовать шифрование SRTP.

По умолчанию запускать командлет **Set-CsTrunkConfiguration** локально могут участники группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которые были назначены для этого командлета (включая все созданные вами роли RBAC), запустите следующую команду из командной строки Windows PowerShell:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Set-CsTrunkConfiguration"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный?</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>ConcentratedTopology</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Значение этого параметра определяет, существует ли известная оконечная точка мультимедиа. (Примером такой точки служит шлюз PSTN, где у точки завершения мультимедиа такой же IP-адрес, что и сигнальной точки завершения.) Присвойте этому параметру значение False, если у магистрали нет известной точки завершения мультимедиа.</p>
<p>По умолчанию: True</p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>Description</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Строка</p></td>
<td><p>Строка, описывающая назначение магистральной конфигурации.</p></td>
</tr>
<tr class="even">
<td><p><em>Enable3pccRefer</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, можно ли использовать протокол 3pcc, чтобы разрешить переключенным звонкам обходить размещенный сайт. 3pcc также называют &quot;протоколом третьего лица&quot;. Он используется, когда третье лицо привлекается для соединения пары звонящих (например, оператор производит вызов от лица А к лицу B). Метод REFER — это стандартный SIP-метод, который указывает, что получатель должен связаться с третьим лицом с помощью информации, предоставленной отправителем. По умолчанию используется значение False ($False).</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableBypass</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Значение этого параметра определяет, включен ли обход мультимедиа для этой магистрали. Установите для параметра значение True, чтобы включить обход. Учтите, что для успешной работы обхода мультимедиа шлюзы PSTN, контроллеры SBC и PBX должны поддерживать определенные возможности, в том числе следующие:</p>
<p>- возможность получения разделенных ответов в приглашении;</p>
<p>- клиенты Lync Server и точка завершения мультимедиа должны иметь возможность для взаимодействия напрямую без прохода через посредник;</p>
<p>- подсеть шлюза должна быть определена на том же сайте, что и подсеть клиента; при использовании разных сайтов они не должны быть разделены каналами WAN с ограниченной пропускной полосой.</p>
<p>Обход мультимедиа можно включать только при следующих обстоятельствах:</p>
<p>- Для параметра ConcentratedTopology задано значение True</p>
<p>- Для параметра EnableReferSupport задано значение False, для RTCPActiveCalls и RTCPCallsOnHold — False, либо для EnableReferSupport задано значение True</p>
<p>Учтите, что если для EnableBypass задано значение True, а для EnableReferSupport — False, обходные вызовы, которые затем переключаются, станут необходными.</p>
<p>Чтобы обход мультимедиа работал для определенной магистрали, его необходимо включить глобально и для соответствующей магистрали. Используйте командлет <strong>New-CsNetworkMediaBypassConfiguration</strong>, чтобы включить обход мультимедиа глобально.</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="even">
<td><p><em>EnableFastFailoverTimer</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Если установлено значение True, исходящие вызовы, ответ шлюза для которых не был получен в течение 10 секунд, будут направляться на следующий доступный магистральный канал; при отсутствии дополнительных магистральных каналов вызов автоматически сбрасывается. В организации с низкой скоростью сети и ответа шлюза это может приводить к сбросу вызовов без необходимости.</p>
<p>Значение по умолчанию — True.</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableLocationRestriction</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Если задано значение True, будет включена маршрутизация голосовых вызовов на основе расположения для вызовов, передаваемых по магистралям SIP, управляемым указанной коллекцией параметров конфигурации магистрали SIP. Маршрутизация голосовых вызовов на основе расположения позволяет учитывать и вызывающих, и вызываемых пользователей при маршрутизации вызовов. Если для этого свойства задано значение True (значение по умолчанию — False), необходимо также задать свойство NetworkSiteId.</p></td>
</tr>
<tr class="even">
<td><p><em>EnableMobileTrunkSupport</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Определяет, является ли поставщик услуг оператором мобильной связи.</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableOnlineVoice</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, поддерживают ли магистрали SIP передачу голоса через Интернет. При этом у пользователей есть локальная учетная запись Lync Server, но их голосовая почта размещается в Skype для бизнеса Online. По умолчанию используется значение False ($False).</p></td>
</tr>
<tr class="even">
<td><p><em>EnablePIDFLOSupport</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Определяет, следует ли направлять экстренные вызовы с объектом PIDF-LO через заданный шлюз. Установите для этого параметра значение True, если экстренные вызовы необходимо направлять сертифицированному поставщику экстренных услуг. (Данные о расположении передаются вместе с вызовом.)</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableReferSupport</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Определяет, поддерживает ли эта магистраль запросы Refer от посредник.</p>
<p>Обход мультимедиа можно включать только при следующих обстоятельствах:</p>
<p>- Для параметра ConcentratedTopology задано значение True</p>
<p>- Для параметра EnableReferSupport задано значение False, для RTCPActiveCalls и RTCPCallsOnHold — False, либо для EnableReferSupport задано значение True</p>
<p>Учтите, что если для EnableBypass задано значение True, а для EnableReferSupport — False, обходные вызовы, которые затем переключаются, станут необходными.</p>
<p>По умолчанию: True</p></td>
</tr>
<tr class="even">
<td><p><em>EnableRTPLatching</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, поддерживают ли магистрали SIP запирание RTP, технологию, которая обеспечивает связь RTP/RTCP через устройство NAT или брандмауэр. Значение по умолчанию — False ($False).</p></td>
</tr>
<tr class="odd">
<td><p><em>EnableSessionTimer</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, включен ли таймер сеанса. Таймеры сеанса используются для определения того, активен ли конкретный сеанс.</p>
<p>Обратите внимание, что даже если для этого параметра задано значение False, таймеры сеанса могут использоваться, если таймер сеанса удаленного соединения включен. В этом случае посредник ответит на пробы таймера сеанса из удаленного объекта.</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="even">
<td><p><em>EnableSignalBoost</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Если для этого параметра задано значение True, шлюз PSTN, IP-PBX и контроллер SBC у поставщика услуг увеличат громкость звука голосовых потоков, отправляемых клиентам посредник и Lync Server. Если значение равно False, громкость звука будет увеличена для посредник (для вызовов без обхода) или в клиентах Lync Server (для вызовов с обходом).</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="odd">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Отменяет вывод каких-либо запросов на подтверждение, которые в противном случае отображались бы перед внесением изменений.</p></td>
</tr>
<tr class="even">
<td><p><em>ForwardCallHistory</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, перенаправляется ли журнал вызовов через магистраль. По умолчанию используется значение False ($False).</p></td>
</tr>
<tr class="odd">
<td><p><em>ForwardPAI</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Указывает, перенаправляется ли заголовок P-Asserted-Identity (PAI) вместе с вызовом. Заголовок PAI позволяет проверить личность звонящего. По умолчанию используется значение False ($False).</p></td>
</tr>
<tr class="even">
<td><p><em>Identity</em></p></td>
<td><p>Необязательный</p></td>
<td><p>XdsIdentity</p></td>
<td><p>Уникальный идентификатор, включающий область действия магистральной конфигурации. Магистральные конфигурации могут существовать на глобальном уровне, уровне сайта или службы шлюза PSTN. Например, site:Redmond (для сайта) или PstnGateway:Redmond.litwareinc.com (для службы).</p></td>
</tr>
<tr class="odd">
<td><p><em>Instance</em></p></td>
<td><p>Необязательный</p></td>
<td><p>TrunkConfiguration</p></td>
<td><p>Позволяет передать в командлет ссылку на объект вместо задания значений отдельных параметров.</p>
<p>Для этого параметра следует указать объект типа Microsoft.Rtc.Management.WritableConfig.Settings.TrunkConfiguration.TrunkConfiguration, который можно извлечь с помощью командлета <strong>Get-CsTrunkConfiguration</strong>.</p></td>
</tr>
<tr class="even">
<td><p><em>MaxEarlyDialogs</em></p></td>
<td><p>Необязательный</p></td>
<td><p>UInt32</p></td>
<td><p>Максимальное число разделенных ответов, которое может получать шлюз PSTN, IP-PBX или контроллер SBC у поставщика услуг в приглашении, отправленном в посредник.</p>
<p>По умолчанию: 20</p></td>
</tr>
<tr class="odd">
<td><p><em>NetworkSiteID</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Строка</p></td>
<td><p>ИД сайта сети связан с коллекцией параметров конфигурации магистрали. Если для свойства EnableLocationRestriction задано значение True, маршрутизация голосовых вызовов на основе расположения по этой магистрали будет управляться с помощью параметров, настроенных для указанного сайта. ИД сайта сети можно получить с помощью этой команды:</p>
<p>Get-CsNetworkSite | Select NetworkSiteID</p></td>
</tr>
<tr class="even">
<td><p><em>OutboundCallingNumberTranslationRulesList</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PSListModifier</p></td>
<td><p>Коллекция правил преобразования исходящих номеров, назначенных магистрали. Вы можете получить информацию о доступных правилах, выполнив эту команду:</p>
<p>Get-CsOutboundCallingNumberTranslationRule</p></td>
</tr>
<tr class="odd">
<td><p><em>OutboundTranslationRulesList</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PSListModifier</p></td>
<td><p>Коллекция правил преобразования телефонных номеров, которые применяются к вызовам, обрабатываемым исходящей маршрутизацией (вызовы, направляемые в PBX и PSTN).</p>
<p>Хотя этот список и эти правила можно изменить непосредственно с помощью этого командлета, рекомендуется изменить правила преобразования исходящих вызовов с помощью командлета <strong>Set-CsOutboundTranslationRule</strong>. Командлет <strong>Set-CsOutboundTranslationRule</strong> изменит правило, а эти изменения будут автоматически отражены в магистральной конфигурации. Чтобы изменить конфигурацию, добавив новое правило преобразования, вызовите командлет <strong>New-CsOutboundTranslationRule</strong>. Новое правило будет добавлено в магистральную конфигурацию с соответствующей областью действия.</p></td>
</tr>
<tr class="even">
<td><p><em>PstnUsages</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PSListModifier</p></td>
<td><p>Коллекция способов использования PSTN, назначенных магистрали. Вы можете получить информацию о доступных способах использования, выполнив эту команду:</p>
<p>Get-CsPstnUsage</p></td>
</tr>
<tr class="odd">
<td><p><em>RemovePlusFromUri</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Если задать для этого параметра значение True, посредник удалит начальные символы плюса (+) из универсальных кодов ресурсов (URI) перед их отправкой поставщику услуг.</p>
<p>Значение по умолчанию: False</p></td>
</tr>
<tr class="even">
<td><p><em>RTCPActiveCalls</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Этот параметр определяет, отправляются ли пакеты RTCP из шлюза PSTN, IP-PBX или контроллера SBC у поставщика услуг для активных вызовов. В этом контексте активным вызовом является вызов, в котором разрешается передавать мультимедиа хотя бы в одном направлении. Если для RTCPActiveCalls задано значение True, посредник или клиент Lync Server могут завершить вызов, если не получит пакеты RTCP в течение 30 секунд.</p>
<p>Учтите, что при отключении проверок полученных объектов мультимедиа RTCP для активных вызовов в элементах Lync Server удаляется важный защитный механизм для обнаружения удаленного объекта. Это следует делать только при необходимости.</p>
<p>По умолчанию: True</p></td>
</tr>
<tr class="odd">
<td><p><em>RTCPCallsOnHold</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Логическое</p></td>
<td><p>Этот параметр определяет, продолжают ли отправляться пакеты RTCP в магистрали для удержанных вызовов, если пакеты мультимедиа не должны передаваться ни в одном направлении. Если функция &quot;Музыка при удержании&quot; включена в клиенте Lync Server или магистрали, вызов будет считаться активным, а это свойство будет игнорироваться. В этих обстоятельствах используйте параметр RTCPActiveCalls.</p>
<p>Учтите, что при отключении проверок полученных пакетов мультимедиа RTCP на наличие активных вызовов в элементах Lync Server удаляется важный защитный механизм для обнаружения удаленного объекта. Это следует делать только при необходимости.</p>
<p>По умолчанию: True</p></td>
</tr>
<tr class="even">
<td><p><em>SipResponseCodeTranslationRulesList</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PSListModifier</p></td>
<td><p>Список правил преобразования кодов ответов SIP, которые применяются к кодам ответов, полученных от шлюза PSTN, IP-PBX или контроллера SBC у поставщика услуг. Эти правила позволяют администратору сопоставить коды ответа SIP со значениями от 400 до 699, полученные по магистрали, с новыми значениями, которые более подходят для Lync Server.</p>
<p>Вы можете создать этот список и соответствующие правила непосредственно с помощью этого командлета. Однако мы рекомендуем создать правила преобразования кодов ответов SIP, вызвав командлет <strong>New-CsSipResponseCodeTranslationRule</strong>. Он создает правило и назначает его магистральной конфигурации с соответствующей областью действия.</p></td>
</tr>
<tr class="odd">
<td><p><em>SRTPMode</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SRTPMode</p></td>
<td><p>Значение этого параметра определяет уровень поддержки SRTP для защиты трафика мультимедиа между посредник и шлюзом PSTN, IP-PBX и контроллером SBC у поставщика услуг. При обходе мультимедиа это значение должно соответствовать параметру EncryptionLevel в конфигурации мультимедиа, которая задается с помощью командлетов <strong>New-CsMediaConfiguration</strong> и <strong>Set-CsMediaConfiguration</strong>.</p>
<p>Допустимые значения:</p>
<p>- Required: необходимо использовать шифрование SRTP.</p>
<p>- Optional: шифрование SRTP будет использоваться, если поставщик услуг поддерживает его.</p>
<p>- NotSupported: шифрование SRTP не поддерживается и не может быть использовано.</p>
<p>Примечание. SRTPMode используется, только если шлюз настроен для применения TLS. Если шлюз использует протокол TCP в качестве транспортного протокола, для параметра SRTPMode автоматически задается значение NotSupported.</p>
<p>Значение по умолчанию: Required</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Объект Microsoft.Rtc.Management.WritableConfig.Settings.TrunkConfiguration.TrunkConfiguration. Принимает конвейерный поток объектов магистральной конфигурации.

## Типы возвращаемых данных

Этот командлет не возвращает значение. Он изменяет объект типа Microsoft.Rtc.Management.WritableConfig.Settings.TrunkConfiguration.TrunkConfiguration.

## См. также

#### Другие ресурсы

[New-CsTrunkConfiguration](new-cstrunkconfiguration.md)  
[Remove-CsTrunkConfiguration](remove-cstrunkconfiguration.md)  
[Get-CsTrunkConfiguration](get-cstrunkconfiguration.md)  
[Test-CsTrunkConfiguration](test-cstrunkconfiguration.md)  
[New-CsOutboundTranslationRule](new-csoutboundtranslationrule.md)  
[Set-CsOutboundTranslationRule](set-csoutboundtranslationrule.md)

