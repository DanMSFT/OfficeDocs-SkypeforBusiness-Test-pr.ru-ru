---
title: Set-CsCdrConfiguration
TOCTitle: Set-CsCdrConfiguration
ms:assetid: 977f0d3e-796b-43a3-bc0c-82ea91741c52
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg398774(v=OCS.15)
ms:contentKeyID: 49310597
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Set-CsCdrConfiguration

 

_**Дата изменения раздела:** 2015-03-09_

Изменяет существующую коллекцию параметров регистрации вызовов (CDR). CDR позволяет отслеживать использование одноранговых сеансов обмена мгновенными сообщениями, телефонных VoIP-звонков, конференций и других компонентов. Данные об использовании включают в себя информацию о вызывающей и вызываемой сторонах, времени звонка и продолжительности разговора. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Set-CsCdrConfiguration [-Identity <XdsIdentity>] <COMMON PARAMETERS>

    Set-CsCdrConfiguration [-Instance <PSObject>] <COMMON PARAMETERS>

    COMMON PARAMETERS: [-Confirm [<SwitchParameter>]] [-EnableCDR <$true | $false>] [-EnablePurging <$true | $false>] [-Force <SwitchParameter>] [-KeepCallDetailForDays <UInt32>] [-KeepErrorReportForDays <UInt32>] [-PurgeHourOfDay <UInt32>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

В примере 1 задается время суток для удаления старых записей. В данном случае используется значение 23 (23:00 в 24-часовом формате). Чтобы гарантировать, что эти изменения вносятся только в параметры CDR с идентификатором site:Redmond, используется параметр Identity.

    Set-CsCdrConfiguration -Identity site:Redmond -PurgeHourOfDay 23 

## ПРИМЕР 2

В примере 2 представлен измененный вариант команды из примера 1. В этом примере в каждой коллекции параметров конфигурации CDR, используемой в организации, изменяется свойство PurgeHourOfDay. Сначала вызывается командлет **Get-CsCdrConfiguration** без параметров, возвращающий коллекцию всех параметров CDR, используемых в настоящее время. Эта коллекция передается в командлет **Set-CsCdrConfiguration**, который циклически обрабатывает каждый из объектов в коллекции и изменяет значение свойств PurgeHourOfDay на 23:00.

    Get-CsCdrConfiguration | Set-CsCdrConfiguration -PurgeHourOfDay 23 

## ПРИМЕР 3

В примере 3 представлен еще один вариант команды из примера 1. В этом примере свойство PurgeHourOfDay изменяется во всех параметрах CDR, настроенных для области сайта. Для этого сначала вызывается командлет **Get-CsCdrConfiguration** с параметром Filter; значение фильтра, "site:\*", гарантирует, что возвращены будут только параметры CDR с идентификатором, который начинается со строкового значения "site:". Отфильтрованная коллекция передается в командлет **Set-CsCdrConfiguration**, который изменяет свойство PurgeHourOfDay каждого из объектов в коллекции.

    Get-CsCdrConfiguration -Filter "site:*"| Set-CsCdrConfiguration -PurgeHourOfDay 23

## Подробное описание

Регистрация вызовов (CDR) позволяет отслеживать использование компонентов Lync Server (телефонных VoIP-звонков, обмена мгновенными сообщениями, передачи файлов, аудио- и видеоконференций, сеансов общего доступа к приложениям и т. д.). Компонент CDR (который доступен только при наличии службы мониторинга) хранит в себе данные об использовании (т. е. и фиксирует данные, в т. ч. о вызывающей и вызываемых сторонах звонка, его продолжительности и факт передачи в ходе звонка файлов). Но сам звонок компонент не записывает.

CDR также отслеживает сведения об ошибках вызовов: подробные диагностические данные для одноранговых сеансов и для конференц-вызовов.

Администраторы могут указывать, должен ли компонент CDR использоваться в организации (мы исходим из предположения, что служба мониторинга уже развернута; в этом случае включение или отключение CDR не представляет проблемы). Это решение можно принять как на глобальном уровне (т. е. включить или отключить CDR в рамках всей организации), так и на уровне конкретных узлов. Например, можно использовать CDR на узле Redmond, но не на узле Paris.

Администраторы также могут управлять и базой данных CDR. Например, можно указать число дней, по прошествии которых хранимые в базе данных записи CDR будут удаляться из нее. Такие изменения вносятся командлетом **Set-CsCdrConfiguration**.

По умолчанию право на локальный запуск командлета **Set-CsCdrConfiguration** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Set-CsCdrConfiguration"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="even">
<td><p><em>EnableCDR</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Указывает, включен ли CDR. По умолчанию установлено значение True.</p></td>
</tr>
<tr class="odd">
<td><p><em>EnablePurging</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Указывает, будут ли записи CDR периодически удаляться из базы данных CDR. При True (значение по умолчанию) записи будут удаляться по истечении периода времени, заданного в свойствах KeepCallDetailForDays (для записей CDR) и KeepErrorReportForDays (для ошибок CDR). Если параметру присвоено значение False, записи CDR будут храниться вечно.</p></td>
</tr>
<tr class="even">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Подавляет отображение любых сообщений о некритических ошибках, которые могут возникать при выполнении этой команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.Xds.XdsIdentity</p></td>
<td><p>Уникальный идентификатор, назначенный коллекции параметров конфигурации CDR. Для ссылки на глобальные параметры используется следующий синтаксис: -Identity global. Для ссылки на коллекцию, настроенную для области узла, рекомендуется использовать синтаксис, подобный следующему: -Identity site:Redmond. Обратите внимание, что при задании параметра Identity нельзя использовать подстановочные знаки.</p>
<p>Если этот параметр не указан, командлет <strong>Set-CsCdrConfiguration</strong> изменит глобальные параметры.</p></td>
</tr>
<tr class="even">
<td><p><em>Instance</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Объект CdrSettings</p></td>
<td><p>Позволяет передать в командлет ссылку на объект вместо задания значений отдельных параметров.</p></td>
</tr>
<tr class="odd">
<td><p><em>KeepCallDetailForDays</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает период времени (в днях), в течение которого записи CDR должны храниться в базе данных CDR. Все записи старше указанного числа дней будут автоматически удаляться (обратите внимание, что удаление выполняется только при присвоении свойству EnablePurging значения true).</p>
<p>В качестве значения этого свойства можно задать любое целое значение от 1 до 2562 дней (приблизительно 7 лет). По умолчанию установлено 60 дней.</p></td>
</tr>
<tr class="even">
<td><p><em>KeepErrorReportForDays</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает число дней, в течение которого сохраняются отчеты об ошибках CDR; все отчеты старше указанного числа дней будут автоматически удаляться. Отчеты об ошибках CDR представляют собой диагностические отчеты, которые отправляют клиентские приложения, такие как Lync 2013.</p>
<p>В качестве значения этого свойства можно задать любое целое значение от 1 до 2562 дней (приблизительно 7 лет). По умолчанию установлено 60 дней.</p></td>
</tr>
<tr class="odd">
<td><p><em>PurgeHourOfDay</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.UInt32</p></td>
<td><p>Указывает местное время суток для удаления записей с истекшим сроком действия из базы данных CDR. Время суток задается в 24-часовом формате (0 соответствует полуночи (00:00), а 23 — 23:00 часам вечера). Обратите внимание, что можно указать только час, т. е. удаление можно запланировать на 4:00 утра, но не на 4:30 или 4:15. Значение по умолчанию — 2 часа утра (02:00). Рекомендуется выполнять удаление в нерабочее время.</p>
<p>Очистка базы данных выполняется только в том случае, если свойство EnablePurging установлено в значение True.</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Microsoft.Rtc.Management.WritableConfig.Settings.CallDetailRecording.CdrSettings. Командлет **Set-CsCdrConfiguration** принимает в качестве входных данных из конвейера объекты конфигурации регистрации вызовов.

## Типы возвращаемых данных

Командлет **Set-CsCdrConfiguration** не возвращает значений или объектов. Он настраивает экземпляры объекта Microsoft.Rtc.Management.WritableConfig.Settings.CallDetailRecording.CDRSettings.

## См. также

#### Другие ресурсы

[Get-CsCdrConfiguration](get-cscdrconfiguration.md)  
[New-CsCdrConfiguration](new-cscdrconfiguration.md)  
[Remove-CsCdrConfiguration](remove-cscdrconfiguration.md)

