---
title: New-CsVoiceRegex
TOCTitle: New-CsVoiceRegex
ms:assetid: a1a498b7-8353-40bd-9c02-424c95743ec3
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg412751(v=OCS.15)
ms:contentKeyID: 49310707
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# New-CsVoiceRegex

 

_**Дата изменения раздела:** 2015-03-09_

Создает шаблон регулярного выражения и алгоритм преобразования для преобразования телефонных номеров в различные форматы. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    New-CsVoiceRegex -AtLeastLength <Int32> [-DigitsToPrepend <String>] [-DigitsToStrip <Int32>] [-StartsWith <String>] <COMMON PARAMETERS>

    New-CsVoiceRegex -ExactLength <Int32> [-DigitsToPrepend <String>] [-DigitsToStrip <Int32>] [-StartsWith <String>] <COMMON PARAMETERS>

    COMMON PARAMETERS:

## Примеры

## ПРИМЕР 1

В этом примере создается новый шаблон регулярного выражения и преобразования. Регулярное выражение содержит шаблон, который должен составлять ровно 7 символов (-ExactLength 7), и удаляет первые три цифры подходящего номера (-DigitsToStrip 3). Шаблон Pattern, созданный данным регулярным выражением, будет ^\\d{3}(\\d{4})$, а преобразование Translation будет $1. Например, номер 5551212 будет подходить к шаблону и результатом преобразования будет 1212: семизначный номер без первых трех цифр.

    $regex = New-CsVoiceRegex -ExactLength 7 -DigitsToStrip 3

## ПРИМЕР 2

В этом примере, как и в предыдущем, тоже создается новый шаблон регулярного выражения и преобразование, но после этого создается новое правило нормализации голосовых данных. В первой строке мы вызываем командлет **New-CsVoiceRegEx** для создания регулярного выражения, в котором подходящий номер должно иметь минимум 7 символов (-AtLeastLength 7) и должен начинаться с "1" (-StartsWith "1"). Результаты команды присваиваются переменной $regex.

Во второй строке вызывается командлет **New-CsVoiceNormalizationRule**. Мы даем новому правилу уникальное имя, в данном случае "global/internal rule". Затем назначаем правилу нормализации шаблон Pattern, созданный командлетом **New-CsVoiceRegex**: -Pattern $regex.Pattern. То же самое делаем с преобразованием Translation, созданным командлетом **New-CsVoiceRegex**: -Translation $regex.Translation.

Примечание. Шаблон Pattern, созданный в этом примере, имеет вид ^(1\\d{5}\\d+)$. Его можно расшифровать как число, начинающееся с 1 (1), за которым идут пять цифр (\\d{5}) и далее любое число цифр (\\d+). Получается число, состоящее минимум из 7 цифр (1 плюс 5, плюс 1 или более), начинающееся с "1", что соответствует условиям задачи.

    $regex = New-CsVoiceRegex -AtLeastLength 7 -StartsWith "1"
    New-CsVoiceNormalizationRule "global/internal rule" -Pattern $regex.Pattern -Translation $regex.Translation

## Подробное описание

Регулярные выражения используются для сопоставления шаблонов символов. Lync Server использует регулярные выражения для преобразования телефонных номеров между различными форматами, включая набранные номера, номера стандарт E.164, номера PBX и номера PSTN. Если администратор не знает синтаксиса и правил форматирования для работы с регулярными выражениями, создание правил преобразования может быть трудной задачей. Командлет **New-CsVoiceRegex** предоставляет параметры, позволяющие задать определенные критерии, и затем создает регулярное выражение.

Используйте этот командлет для создания регулярных выражений, применяемых в качестве значений переменных Pattern и Translation для правил нормализации (командлет **New-CsVoiceNormalizationRule**) и правил преобразования исходящих вызовов (командлет **New-CsOutboundTranslationRule**), а также значения переменной NumberPattern для маршрутизации голосовых данных (командлет **New-CsVoiceRoute**).

По умолчанию право на локальный запуск командлета **New-CsVoiceRegex** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "New-CsVoiceRegex"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный?</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>AtLeastLength</em></p></td>
<td><p>Обязательный</p></td>
<td><p>System.Int32</p></td>
<td><p>Минимальная длина строки (телефонный номер), удовлетворяющая выражению. Например, если необходимо создать правило нормализации, влияющее только на номера, состоящие минимум из семи цифр (или символов), задайте данному параметру значение 7.</p>
<p>Необходимо ввести значение для этого параметра или для параметра ExactLength. Невозможно ввести значения для обоих параметров.</p></td>
</tr>
<tr class="even">
<td><p><em>ExactLength</em></p></td>
<td><p>Обязательный</p></td>
<td><p>System.Int32</p></td>
<td><p>Длина, которой должна соответствовать строка (телефонный номер), чтобы удовлетворять регулярному выражению. Например, если требуется, чтобы правило нормализации затрагивало только 10-значные номера, укажите для этого параметра значение 10.</p>
<p>Необходимо ввести значение для этого параметра или для параметра AtLeastLength. Невозможно ввести значения для обоих параметров.</p></td>
</tr>
<tr class="odd">
<td><p><em>DigitsToPrepend</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Строка, задающая знаки или числа для добавления в начало телефонного номера. Значение, введенное для данного параметра будет влиять на правило Translation, добавляя знаки к номеру, совпадающему с регулярным выражением Pattern. Например, если номером, совпадающим с шаблоном, является 5551212, а параметр DigitsToPrepend имеет значение 425, преобразованный номер будет 4255551212 (предполагая, что никакие другие преобразования не применялись).</p></td>
</tr>
<tr class="even">
<td><p><em>DigitsToStrip</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Int32</p></td>
<td><p>Число знаков, которые требуется удалить из начала строки (телефонного номера). Например, если введено число 2065551212, и параметр DigitsToStrip имеет значение 3, номер будет преобразован в 5551212.</p></td>
</tr>
<tr class="odd">
<td><p><em>StartsWith</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Первый знак строки (номер телефона). Строка не будет совпадать с регулярным выражением, если она не начинается со строки, заданной в параметре StartsWith. Например, если для параметра StartsWith задано значение &quot;+1&quot;, шаблону будут удовлетворять только номера, начинающиеся с &quot;+1&quot;, и они будут преобразованы. Обратите внимание, что число символов в строке StartsWith будет включено в суммы ExactLength и AtLeastLength. Например, если для параметра ExactLength задано значение 10, а параметр StartsWith имеет значение &quot;+1&quot;, подходящий телефонный номер будет иметь длину 8 символов, перед которыми стоит &quot;+1&quot;, давая в сумме 10 символов.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Нет.

## Типы возвращаемых данных

Создает объект типа Microsoft.Rtc.Management.Voice.OcsVoiceRegex.

## См. также

#### Другие ресурсы

[New-CsVoiceNormalizationRule](new-csvoicenormalizationrule.md)  
[New-CsOutboundTranslationRule](new-csoutboundtranslationrule.md)  
[New-CsVoiceRoute](new-csvoiceroute.md)

