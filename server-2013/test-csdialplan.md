---
title: Test-CsDialPlan
TOCTitle: Test-CsDialPlan
ms:assetid: e6618394-82c5-4bc2-85cc-97ac4686a1aa
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg399024(v=OCS.15)
ms:contentKeyID: 49311497
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Test-CsDialPlan

 

_**Дата изменения раздела:** 2015-03-09_

Тестирует номер телефона на абонентскую группу (которая раньше называлась профилем местоположения) и возвращает правило нормализации, которое будет применяться к номеру, а также преобразованный номер после применения правила нормализации. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Test-CsDialPlan -DialedNumber <PhoneNumber> -Dialplan <LocationProfile>

## Примеры

## ПРИМЕР 1

В этом примере выполняется тестирование абонентской группы с удостоверением site:Redmond. Сначала выполняется командлет **Get-CsDialPlan** для извлечения абонентской группы с удостоверением site:Redmond. Затем этот объект абонентской группы передается в командлет **Test-CsDialPlan**, в котором выполняется тестирование абонентской группы на телефонный номер 14255559999. Результатом будет значение DialedNumber, к которому применяется правило нормализации с соответствующим шаблоном. Если на узле имеется несколько правил нормализации с соответствующим шаблоном, то будет применяться правило с самым низким значением свойства Priority. Если отсутствуют правила с шаблонами, соответствующими значению DialedNumber (например, если правило нормализации соответствует шаблону для 11-значного номера, а предоставляется 7-значный номер), то никакое значение не возвращается.

Результат выполнения этой команды включает номер телефона и правило нормализации. Правило нормализации имеет числовые свойства, и по умолчанию этот результат заканчивается многоточием (...). Чтобы увидеть все свойства и значения извлеченного правила нормализации, мы передаем этот результат в командлет **Format-List** перед его выводом на экран.В итоге телефонный номер и правило нормализации будут выведены на отдельных строках, а свойства и значения правила нормализации будут переноситься, чтобы поместиться на экране.

    Get-CsDialPlan -Identity site:Redmond | Test-CsDialPlan -DialedNumber 14255559999 | Format-List

## ПРИМЕР 2

Пример 2 идентичен примеру 1, за исключением того, что вместо передачи результатов операции Get непосредственно в командлет **Test-CsDialPlan** объект сначала сохраняется в переменной $a, а затем передается как значение в параметр DialPlan, используемый в качестве абонентской группы, для которой будет выполняться тестирование.

Как и в примере 1, мы завершаем эту команду передачей результата в командлет **Format-List**, поэтому можно увидеть больше сведений о правиле нормализации, чем отображается по умолчанию.

    $a = Get-CsDialPlan -Identity site:Redmond
    Test-CsDialPlan -DialedNumber 14255559999 -Dialplan $a | Format-List

## ПРИМЕР 3

В этом примере выполняется тестирование всех абонентских групп, заданных в развертывании Lync Server. Сначала выполняется командлет **Get-CsDialPlan** (без параметров), чтобы извлечь все абонентские группы. Затем полученная коллекция абонентских групп передается в командлет **Test-CsDialPlan**, где каждая абонентская группа в коллекции тестируется на номер 2065559999. В результате получится список преобразованных номеров с примененным правилом нормализации (по одному правилу нормализации для каждой абонентской группы в коллекции). Если ни одно правило нормализации в абонентской группе не применяется к значению DialedNumber для конкретной абонентской группы (например, если правило нормализации соответствует шаблону для 11-значного номера, а предоставлен 7-значный номер), то в списке для этой абонентской группы будет пустая строка.

По умолчанию в результате обрезается полное отображение примененного правила нормализации. В примерах 1 и 2 мы могли видеть полное отображение, направляя результат теста в командлет **Format-List**. В данном примере мы направляем результат в командлет **Format-Table** и включаем параметр Wrap. Мы получим каждую запись в формате таблицы (в одном столбце будет преобразованный номер, а в другом — примененное правило нормализации), но правило нормализации будет переноситься в пределах столбца.

    Get-CsDialPlan | Test-CsDialPlan -DialedNumber 2065559999 | Format-Table -Wrap

## Подробное описание

Этот командлет позволяет увидеть результат применения абонентской группы к указанному телефонному номеру. Абонентские группы предоставляют сведения, включая сведения о примененных правилах нормализации, которые необходимы для того, чтобы пользователи корпоративной голосовой связи могли делать телефонные звонки. Принимая во внимание набранный номер и абонентскую группу, этот командлет будет проверять, какое правило нормализации в данной абонентской группе будет применяться, и каким будет преобразованный номер.

Этот командлет можно использовать для устранения проблем с преобразованием номеров или для проверки применения правил к конкретным номерам.

По умолчанию право на локальный запуск командлета **Test-CsDialPlan** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Test-CsDialPlan"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный?</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>DialedNumber</em></p></td>
<td><p>Обязательный</p></td>
<td><p>PhoneNumber</p></td>
<td><p>Телефонный номер, для которого требуется тестировать абонентскую группу, указанную в параметре Dialplan.</p>
<p>Полный тип данных: Microsoft.Rtc.Management.Voice.PhoneNumber</p></td>
</tr>
<tr class="even">
<td><p><em>Dialplan</em></p></td>
<td><p>Обязательный</p></td>
<td><p>LocationProfile</p></td>
<td><p>Объект, содержащий ссылку на абонентскую группу, по отношению к которой требуется тестировать номер, заданный в параметре DialedNumber.</p>
<p>Полный тип данных: Microsoft.Rtc.Management.WritableConfig.Policy.Voice.LocationProfile</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Объект Microsoft.Rtc.Management.WritableConfig.Policy.Voice.LocationProfile. Принимает в качестве входных данных объекты абонентской группы, переданные по конвейеру.

## Типы возвращаемых данных

Возвращает объект типа Microsoft.Rtc.Management.Voice.LocationProfileTestResult.

## См. также

#### Другие ресурсы

[New-CsDialPlan](new-csdialplan.md)  
[Remove-CsDialPlan](remove-csdialplan.md)  
[Set-CsDialPlan](set-csdialplan.md)  
[Get-CsDialPlan](get-csdialplan.md)  
[Grant-CsDialPlan](grant-csdialplan.md)

