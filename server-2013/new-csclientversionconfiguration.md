---
title: New-CsClientVersionConfiguration
TOCTitle: New-CsClientVersionConfiguration
ms:assetid: e7aac850-9e29-4d18-8929-74a89e9355cd
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg399029(v=OCS.15)
ms:contentKeyID: 49311508
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# New-CsClientVersionConfiguration

 

_**Дата изменения раздела:** 2015-03-09_

Создает новую коллекцию параметров конфигурации версий клиентов. Параметры конфигурации версий клиентов определяют, проверяет ли Lync Server номер версии каждого клиентского приложения, которое входит в систему. Если фильтрация версий клиентов включена, то возможность доступа к системе для клиентского приложения будет зависеть от параметров, заданных в соответствующей политике версий клиентов. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    New-CsClientVersionConfiguration -Identity <XdsIdentity> [-Confirm [<SwitchParameter>]] [-DefaultAction <Allow | AllowWithUrl | Block | BlockWithUrl>] [-DefaultURL <String>] [-Enabled <$true | $false>] [-Force <SwitchParameter>] [-InMemory <SwitchParameter>] [-WhatIf [<SwitchParameter>]]

## Примеры

## ПРИМЕР 1

Команда, показанная в примере 1, создает новую коллекцию параметров конфигурации версий клиентов для узла Redmond. В этой команде параметр Enabled устанавливается в значение False, что означает отключение фильтрации клиента для узла Redmond.

    New-CsClientVersionConfiguration -Identity site:Redmond -Enabled $False

## ПРИМЕР 2

В примере 2 показывается, как можно создать новую коллекцию параметров конфигурации версий клиентов в памяти, изменить эту коллекцию, а затем преобразовать виртуальные параметры в фактическую коллекцию параметров, применимую к узлу Redmond. Для выполнения этой задачи в первой команде с помощью командлета **New-CsClientVersionConfiguration** и параметра InMemory создается коллекция параметров только в памяти с удостоверением site:Redmond. Эта коллекция сохраняется в переменной с именем $x и существует только в памяти: если закрыть сеанс Windows PowerShell или удалить переменную $x, то эти параметры конфигурации версий клиентов исчезнут и никогда не будут применяться к узлу Redmond.

В команде 2 свойство DefaultAction виртуальных параметров устанавливается в значение Block. В команде 3 с помощью командлета **Set-CsClientVersionConfiguration** виртуальные параметры преобразуются в фактическую коллекцию параметров конфигурации версий клиентов, применимую к узлу Redmond.

    $x = New-CsClientVersionConfiguration -Identity site:Redmond -InMemory
    $x.DefaultAction = "Block" 
    Set-CsClientVersionConfiguration -Instance $x

## Подробное описание

Lync Server дает администраторам значительную свободу действий, когда приходится указывать клиентское программное обеспечение (и, что не менее важно, номер версии этого ПО), которое пользователи могут применять для входа в систему. Например, нет никаких технических причин, требующих от пользователей входить на Lync Server с помощью Lync; нет никаких технических ограничений, запрещающих пользователям входить с использованием Microsoft Office Communicator 2007 R2.

Однако по некоторым нетехническим причинам может требоваться выполнение входа пользователями без применения Office Communicator 2007 R2. Office Communicator 2007 R2 не поддерживает все функции и возможности Lync. В результате пользователи, выполнившие вход с использованием Office Communicator 2007 R2, будут работать с системой не так, как пользователи Lync. Это может создать определенные трудности для пользователей и сотрудников службы поддержки, которым придется отвечать на вопросы, связанные с разными клиентскими приложениями.

Если это может создать трудности в вашей организации, можно применить фильтрацию версий клиентов, чтобы указать клиентские приложения, которые могут использоваться для входа в Lync Server. После установки Lync Server устанавливается и включается глобальный набор параметров конфигурации клиентских версий. Эти параметры используются для определения, включена ли фильтрация по версиям клиентов.

Кроме глобальных параметров, командлет **New-CsClientVersionConfiguration** позволяет создавать параметры конфигурации клиентских версий на уровне узла. Когда параметры конфигурации версий клиентов применяются на уровне узла, они имеют преимущество перед глобальными параметрами. Например, предположим, что на глобальном уровне включена фильтрация версий клиентов, а затем для узла Redmond создана отдельная коллекция параметров, в которой фильтрация версий клиентов отключена. В таком случае фильтрация клиентов будет отключена для всех пользователей, имеющих учетные записи на узле Redmond.

Однако следует отметить, что на анонимных пользователей влияют только глобальные параметры, поскольку анонимные пользователи не связаны с узлом.

Обратите внимание, что конфигурация версий клиентов не является компонентом обеспечения безопасности. Технология основана на данных, предоставляемых клиентскими приложениями, и не пытается проверить их точность (т. е. что приложение действительно то самое, за которое оно себя выдает, и что его номер версии соответствует действительности).

По умолчанию право на локальный запуск командлета **New-CsClientVersionConfiguration** имеют члены группы RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которым назначен этот командлет (включая все самостоятельно созданные роли RBAC), выполните в командной строке Windows PowerShell следующую команду:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "New-CsClientVersionConfiguration"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Обязательный</p></td>
<td><p>Microsoft.Rtc.Management.Xds.XdsIdentity</p></td>
<td><p>Представляет уникальный идентификатор, который должен быть назначен новой коллекции параметров конфигурации версий клиентов. Поскольку новые коллекции можно создавать только на уровне узла, удостоверение всегда будет иметь префикс &quot;site:&quot;, за которым будет следовать имя узла, например &quot;site:Redmond&quot;. Обратите внимание, что если коллекция параметров с удостоверением site:Redmond уже существует, то предыдущая команда завершится неудачно.</p>
<p></p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Запрашивает подтверждение перед выполнением команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>DefaultAction</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Microsoft.Rtc.Management.WritableConfig.Policy.ClientVersion.DefaultAction</p></td>
<td><p>Указывает действие, которое следует предпринять, если пользователь пытается выполнить вход из клиентского приложения, номер версии которого не обнаруживается в соответствующей политике версий клиентов. В качестве DefaultAction должно быть указано одно из следующих значений:</p>
<p>Allow. Клиентское приложение получит разрешение на вход.</p>
<p>AllowWithUrl. Клиентское приложение получит разрешение на вход. Кроме того, пользователю будет отображено сообщение, содержащее URL-адрес веб-страницы, на которой пользователь может загрузить утвержденное клиентское приложение. URL-адрес этой веб-страницы следует задать в качестве значения свойства DefaultUrl.</p>
<p>Block. Вход клиентскому приложению будет запрещен.</p>
<p>BlockWithUrl. Вход клиентскому приложению будет запрещен. При этом в сообщении &quot;Доступ запрещен&quot;, которое отображается пользователю, будет указан URL-адрес веб-страницы, на которой пользователь может загрузить утвержденное клиентское приложение. URL-адрес этой веб-страницы следует задать в качестве значения свойства DefaultUrl.</p>
<p>Это свойство игнорируется, если свойство Enabled установлено в значение False. Если свойство Enabled имеет значение False, фильтрация по версиям клиентов не выполняется.</p></td>
</tr>
<tr class="even">
<td><p><em>DefaultURL</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.String</p></td>
<td><p>Указывает URL-адрес веб-страницы, где пользователи могут загрузить утвержденное клиентское приложение. Если это свойство задано, а параметр DefaultAction имеет значение BlockWithUrl, то этот URL-адрес будет отображаться в окне сообщений &quot;Доступ запрещен&quot;, появляющемся всякий раз при попытке пользователя войти из клиентского приложения, которое не поддерживается.</p></td>
</tr>
<tr class="odd">
<td><p><em>Enabled</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Boolean</p></td>
<td><p>Указывает, включена ли фильтрация клиентских версий. Если свойство Enabled имеет значение True, то сервер будет проверять номер версии каждого клиентского приложения, которое пытается выполнить вход; затем сервер будет разрешать или запрещать доступ, исходя из соответствующей политики версий клиентов. Если свойство Enabled имеет значение False, то вход будет разрешен любому клиентскому приложению, которое в состоянии войти.</p>
<p>Значение по умолчанию — True.</p></td>
</tr>
<tr class="even">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Подавляет отображение любых сообщений о некритических ошибках, которые могут возникать при выполнении этой команды.</p></td>
</tr>
<tr class="odd">
<td><p><em>InMemory</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Создает ссылку на объект без фиксации объекта в качестве постоянного изменения. Если выходные данные этого командлета, вызванного с помощью указанного параметра, назначаются переменной, можно внести изменения в свойства ссылки на объект и затем зафиксировать эти изменения, вызвав соответствующий командлет Set-.</p></td>
</tr>
<tr class="even">
<td><p><em>WhatIf</em></p></td>
<td><p>Необязательный</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Описывает, что произойдет при выполнении команды без реального выполнения команды.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Нет. Командлет **New-CsClientVersionConfiguration** не принимает входные данные из конвейера.

## Типы возвращаемых данных

Создает новые экземпляры объекта Microsoft.Rtc.Management.WritableConfig.Policy.ClientVersion.ClientVersionConfiguration.

## См. также

#### Другие ресурсы

[Get-CsClientVersionConfiguration](get-csclientversionconfiguration.md)  
[Remove-CsClientVersionConfiguration](remove-csclientversionconfiguration.md)  
[Set-CsClientVersionConfiguration](set-csclientversionconfiguration.md)

