---
title: Test-CsVoicePolicy
TOCTitle: Test-CsVoicePolicy
ms:assetid: 4d631e36-3a9d-4ca2-913f-8c9f4e93183d
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg398310(v=OCS.15)
ms:contentKeyID: 49309714
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Test-CsVoicePolicy

 

_**Дата изменения раздела:** 2015-03-09_

Проверяет номер телефона применительно голосовой политики и проверяет голосовой маршрут, который будет использоваться применительно к этой политике для данного номера. Данный командлет впервые появился в Lync Server 2010.

## Синтаксис

    Test-CsVoicePolicy -TargetNumber <PhoneNumber> -VoicePolicy <VoicePolicy> [-Force <SwitchParameter>] [-RouteSettings <PstnRoutingSettings>]

## Примеры

## ПРИМЕР 1

В этом примере выполняется проверка голосовой политики применительно к голосовой политике со значением параметра Identity, равным site:Redmond. Сначала командлет **Get-CsVoicePolicy** запускается, чтобы получить политику со значением параметра Identity, равным site:Redmond. Этот объект политики затем передается командлету **Test-CsVoicePolicy**, где данная политика тестируется применительно к номеру телефона +14255559999. Выходные данного будут представлять первый голосовой маршрут (основан на свойстве Priority данного маршрута), шаблон номера которого совпадает со значением TargetNumber, и использование телефона соответствует использованию телефона в политике. Если не будет найдено ни одного маршрута (например, если шаблон номера соответствует шаблону для 11-значного номера, а был указан 7-значный номер), будет возвращено нулевое значение.

    Get-CsVoicePolicy -Identity site:Redmond | Test-CsVoicePolicy -TargetNumber "+14255559999"

## ПРИМЕР 2

Пример 2 отличается от примера 1 только тем, что вместо передачи результатов операции Get непосредственно командлету **Test-CsVoicePolicy** соответствующий объект сначала сохраняется в переменной $a, а затем передается в виде значения параметру VoicePolicy для использования в качестве политики, относительно которой будет выполняться тестирование.

    $a = Get-CsVoicePolicy -Identity site:Redmond
    Test-CsVoicePolicy -TargetNumber "+14255559999" -VoicePolicy $a

## ПРИМЕР 3

В этом примере тестирование голосовой политика выполняется применительно ко всем голосовым политикам, определенным при развертывании Lync Server. Сначала запускается командлет **Get-CsVoicePolicy** (без параметров) для получения всех голосовых политик. Возвращаемая им коллекция политик передается командлету **Test-CsVoicePolicy**, где каждая политика в коллекции проверяется на соответствие маршрута, основанного на представленном целевом номере телефона (+12065559999) и использовании телефона. Выходные данные будут представлять собой соответствующие маршруты, а также соответствующие сведения об использовании телефона.

    Get-CsVoicePolicy | Test-CsVoicePolicy -TargetNumber "+12065559999"

## Подробное описание

Голосовые политики связаны с голосовыми маршрутами через использование телефонной сети общего пользования (PSTN). Звонок от пользователя, назначенного конкретной голосовой политике, может быть направлен по маршруту, в котором использование PSTN соответствует использованию, определенному в данной политике, а также шаблон номера соответствует набранному номеру. Вызовите командлет **Test-CsVoicePolicy**, чтобы определить, какой маршрут (если имеется) будет использован для маршрутизации звонка от пользователя с данной конкретной голосовой политикой, а также использование какого телефона связывает данную политику с данным маршрутом.

Кто может запускать этот командлет: по умолчанию локально запускать командлет **Test-CsVoicePolicy** имеют право участники следующих групп: RTCUniversalServerAdmins. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которые были назначены для этого командлета (включая все созданные вами роли RBAC), выполните следующую команду из командной строки Windows PowerShell:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Test-CsVoicePolicy"}

## Параметры


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный?</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>TargetNumber</em></p></td>
<td><p>Обязательный</p></td>
<td><p>PhoneNumber</p></td>
<td><p>Номер телефона применительно к которому выполнялось тестирование. Этот номер должен быть в формате E.164 (например +14255551212).</p></td>
</tr>
<tr class="even">
<td><p><em>VoicePolicy</em></p></td>
<td><p>Обязательный</p></td>
<td><p>VoicePolicy</p></td>
<td><p>Ссылка на объект голосовой политики, применительно к которому запускается тест. Объекты голосовой политики могут получаться посредством вызова командлета <strong>Get-CsVoicePolicy</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><em>Force</em></p></td>
<td><p>Необязательный</p></td>
<td><p>SwitchParameter</p></td>
<td><p>Отменяет при выполнении командлета отображение запросов на подтверждение для сообщений о некритических ошибках.</p></td>
</tr>
<tr class="even">
<td><p><em>RouteSettings</em></p></td>
<td><p>Необязательный</p></td>
<td><p>PstnRoutingSettings</p></td>
<td><p>Параметры маршрута, относительно которого запускается тест. Данные параметры маршрута могут быть получены с помощью вызова командлета <strong>Get-CsRoutingConfiguration</strong>.</p></td>
</tr>
</tbody>
</table>


## Типы входных данных

Объект Microsoft.Rtc.Management.WritableConfig.Policy.Voice.VoicePolicy. Принимает входные данные объектов политики голосовых служб из конвейера.

## Типы возвращаемых данных

Возвращает объект типа Microsoft.Rtc.Management.Voice.VoicePolicyTestResult.

## См. также

#### Другие ресурсы

[New-CsVoicePolicy](new-csvoicepolicy.md)  
[Remove-CsVoicePolicy](remove-csvoicepolicy.md)  
[Set-CsVoicePolicy](set-csvoicepolicy.md)  
[Get-CsVoicePolicy](get-csvoicepolicy.md)  
[Grant-CsVoicePolicy](grant-csvoicepolicy.md)

